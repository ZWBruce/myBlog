(this["webpackJsonpmy-blog"]=this["webpackJsonpmy-blog"]||[]).push([[0],{143:function(e,t,a){e.exports=a(357)},148:function(e,t,a){},153:function(e,t,a){},154:function(e,t,a){},155:function(e,t,a){},156:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){},185:function(e,t,a){},351:function(e,t,a){},352:function(e,t,a){},353:function(e,t,a){},354:function(e,t,a){},357:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(12),l=a.n(r),i=(a(148),a(51)),o=a.n(i),s=a(77),u=a(5),m=a(20),d=Object(n.createContext)({}),p=(a(153),function(e){var t=Object(n.useContext)(d),a=Object(n.useMemo)((function(){var a=e.info.img;return a||"".concat(t.host,"/files/download?name=1.jpg")}),[t.host,e.info.img]);return c.a.createElement("div",{className:"article-wrap card-bg"},c.a.createElement("img",{src:a,alt:""}),c.a.createElement("div",{className:"content-wrap"},c.a.createElement("div",{className:"notice mb-7"},c.a.createElement("span",null,"1\u5929\u524d"),c.a.createElement("span",null,e.info.category&&e.info.category.category_name)),c.a.createElement("h1",{className:"title link"},e.info.title),c.a.createElement("div",{className:"abstract"})))});function f(e){return c.a.createElement(c.a.Fragment,null,e.list.map((function(e){return c.a.createElement(p,{info:e,key:e.id})})))}a(154);var g=a(31),v=a.n(g);var E=Object(m.b)((function(e){return Object(u.a)({},e)}),{add:function(){return{type:"ADD"}},asyncAdd:function(){return function(e,t){setTimeout((function(){e({type:"ADD"})}),2e3)}}})((function(e){var t=Object(n.useContext)(d),a=v()(),r=v()(1598195948672);return console.log("dayjs",v.a.duration(a.diff(r))),c.a.createElement("div",{className:"card-content card-bg"},c.a.createElement("img",{src:"".concat(t.host,"/files/download?name=1.jpg"),alt:""}),c.a.createElement("span",{className:"name",onClick:function(){e.add()}},"\u51c9\u57ce",e.count),c.a.createElement("span",{onClick:function(){e.asyncAdd()}},"\u4e0d\u8d1f\u521d\u5fc3\uff0c\u65b9\u5f97\u59cb\u7ec8"),c.a.createElement("nav",{className:"level"},c.a.createElement("div",{className:"level-item"},c.a.createElement("p",{className:"heading"},"\u6587\u7ae0"),c.a.createElement("p",{className:"title"},e.articleCount)),c.a.createElement("div",{className:"level-item"},c.a.createElement("p",{className:"heading"},"\u5206\u7c7b"),c.a.createElement("p",{className:"title"},e.ctgCount)),c.a.createElement("div",{className:"level-item"},c.a.createElement("p",{className:"heading"},"\u6807\u7b7e"),c.a.createElement("p",{className:"title"},e.tagsCount))))})),b=a(40);a(155);var h=Object(m.b)((function(e){return Object(u.a)({},e)}))((function(e){var t=Object(n.useContext)(d),a=Object(n.useState)([]),r=Object(b.a)(a,2),l=r[0],i=r[1],o=Object(n.useCallback)((function(e){return e=+e,v()(e).format("YYYY-MM-DD HH:mm:ss")}),[]);return Object(n.useEffect)((function(){i(e.sortedArticle)}),[e.sortedArticle]),c.a.createElement("div",{className:"list-wrap card-bg"},c.a.createElement("div",{className:"notice mb-10"},"\u6700\u65b0\u6587\u7ae0"),c.a.createElement("div",null,l.map((function(e){return c.a.createElement("div",{className:"item-wrap",key:e.id},c.a.createElement("img",{src:e.img||"".concat(t.host,"/files/download?name=1.jpg"),alt:e.title}),c.a.createElement("div",{className:"item-right"},c.a.createElement("div",{className:"date notice"},o(e.time)),c.a.createElement("div",{className:"title link"},e.title),c.a.createElement("div",{className:"tag-wrap"},e.tags.map((function(e,t){return c.a.createElement("div",{className:"tag notice",key:t},e.tag_name)})))))}))))})),O=a(17);a(156);var j=Object(m.b)((function(e,t){return Object(u.a)(Object(u.a)({},e),t)}))(Object(O.f)((function(e){var t=Object(n.useMemo)((function(){var t=e.ctgList;return e.noLimit?t:t.slice(0,7)}),[e]),a=Object(n.useMemo)((function(){return"/catagory"===e.location.pathname}),[e.location.pathname]);return c.a.createElement("div",{className:"ctg-wrap card-bg"},c.a.createElement("div",{className:"notice mb-10 card-head"},c.a.createElement("span",null,"\u5206\u7c7b"),c.a.createElement("a",{onClick:function(){a||e.history.push("/catagory")},style:{visibility:a?"hidden":"visible"}},"\u67e5\u770b\u66f4\u591a")),c.a.createElement("ul",null,t.map((function(e){return c.a.createElement("li",{className:"item-wrap",key:e.id},c.a.createElement("span",null,e.category_name),c.a.createElement("span",null,e.count))}))))})));a(158);var y=Object(m.b)((function(e){return Object(u.a)({},e)}))(Object(O.f)((function(e){var t=Object(n.useMemo)((function(){return"/tags"===e.location.pathname}),[e.location.pathname]);return c.a.createElement("div",{className:"tag-wrap card-bg"},c.a.createElement("div",{className:"notice mb-10 card-head"},c.a.createElement("span",null,"\u6807\u7b7e"),c.a.createElement("a",{onClick:function(){t||e.history.push("/tags")},style:{visibility:t?"hidden":"visible"}},"\u67e5\u770b\u66f4\u591a")),c.a.createElement("ul",null,e.tagsList.map((function(e){return c.a.createElement("li",{className:"item-wrap",key:e.id},c.a.createElement("a",null,e.tag_name))}))))})));var C=Object(m.b)((function(e){return Object(u.a)({},e)}))((function(e){return c.a.createElement("div",{className:"app main-wrapp"},c.a.createElement("div",{className:"flex-left"},c.a.createElement(E,null),c.a.createElement(j,null),c.a.createElement(y,null)),c.a.createElement("div",{className:"flex-center"},c.a.Children.map(e.children,(function(e){return c.a.createElement(c.a.Fragment,null,e)}))),c.a.createElement("div",{className:"flex-right"},c.a.createElement(h,null)))}));var w=Object(m.b)((function(e){return Object(u.a)({},e)}))((function(e){return c.a.createElement(C,null,c.a.createElement(f,{list:e.articleList}))})),N=a(54),_=(a(159),function(e){return c.a.createElement("nav",{className:"app-header"},c.a.createElement("div",{className:"app app-inner-header"},c.a.Children.map(e.children,(function(e){return c.a.createElement("div",null,e)})),c.a.createElement("div",{className:"links"},[{text:"\u4e3b\u9875",url:"/index"},{text:"\u5206\u7c7b",url:"/catagory"},{text:"\u6807\u7b7e",url:"/tags"}].map((function(e,t){var a=e.url,n=e.text;return c.a.createElement(N.b,{to:a,key:t,activeClassName:"active"},n)})))))}),T=function(){return c.a.createElement(C,null,c.a.createElement(j,null))};var k=Object(m.b)((function(e){return Object(u.a)({},e)}))((function(e){return c.a.createElement(C,null,c.a.createElement("div",{className:"ctg-wrap card-bg"},c.a.createElement("div",{className:"notice mb-10"},"\u6807\u7b7e"),c.a.createElement("ul",null,e.tagsList.map((function(e){return c.a.createElement("li",{className:"item-wrap",key:e.id},c.a.createElement("span",null,e.tag_name),c.a.createElement("span",null,e.tag_name.length))})))))})),x=(a(160),a(94)),L=a.n(x),A=(a(97),a(50)),G=a.n(A),D=a(57),S=(a(163),a(52)),M=a.n(S),$=(a(165),a(78)),I=a.n($),R=a(36),F=a.n(R),H=(a(185),a(134)),B=a.n(H),P=I.a.Option,V=M.a.TextArea,Y={title:"",content:"",tags:[],img:"",ctg:{}};function J(e,t){var a=e.tags,n=t.val;switch(t.type){case"changeTitle":return Object(u.a)(Object(u.a)({},e),{},{title:n});case"changeContent":return Object(u.a)(Object(u.a)({},e),{},{content:n});case"ADD_TAG":return a.every((function(e){return e.id!==n.id}))&&a.push(n),Object(u.a)(Object(u.a)({},e),{},{tags:Object(D.a)(a)});case"REMOVE_TAG":return a=a.filter((function(e){return e.id!==n})),Object(u.a)(Object(u.a)({},e),{},{tags:Object(D.a)(a)});case"CHANGE_IMG":return Object(u.a)(Object(u.a)({},e),{},{img:n});case"GET_CTG":return Object(u.a)(Object(u.a)({},e),{},{ctg:n});case"REMOVE_CTG":return Object(u.a)(Object(u.a)({},e),{},{ctg:""});default:return e}}var W=Object(m.b)((function(e){return Object(u.a)({},e)}),{add_tag:function(e){return{type:"ADD_TAG",val:e}},add_ctg:function(e){return{type:"ADD_CTG",val:e}}})((function(e){var t=Object(n.useReducer)(J,Y),a=Object(b.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(""),o=Object(b.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(""),p=Object(b.a)(m,2),f=p[0],g=p[1],v=Object(n.useState)(""),E=Object(b.a)(v,2),h=E[0],O=E[1],j=Object(n.useContext)(d),y=Object(n.useRef)(null);function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"changeTitle";l({type:t,val:e.target.value})}function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tags";if(("tags"!==t||s)&&("category"!==t||f)){var a="".concat(j.host,"/").concat(t,"/add"),n=new FormData;"tags"===t&&n.append("name",s),"category"===t&&n.append("name",f),F()({url:a,method:"post",data:n}).then((function(a){var n=a.data;console.log(n),"tags"===t&&e.add_tag(n),"category"===t&&e.add_ctg(n)}))}}var N=Object(n.useCallback)((function(e){var t=e.split("$_$")[0],a=e.split("$_$")[1];l({type:"ADD_TAG",val:{tag_name:t,id:a}})}),[]),_=Object(n.useCallback)((function(e){var t=e.split("$_$")[0];l({type:"GET_CTG",val:{name:t,id:e.split("$_$")[1]}})}),[]),T=Object(n.useCallback)((function(){console.log("blur")}),[]),k=Object(n.useCallback)((function(e){console.log("search",e)}),[]);return c.a.createElement("div",{className:"write-wrap"},c.a.createElement("div",{className:"flex"},c.a.createElement(M.a,{value:r.title,onChange:function(e){return C(e)},placeholder:"\u6587\u7ae0\u6807\u9898"}),c.a.createElement(G.a,{type:"primary",onClick:function(){if(r.title&&r.content){var e="".concat(j.host,"/articles/send"),t=new FormData;t.append("title",r.title),t.append("content",r.content);var a=r.tags.map((function(e){return e.id}));t.append("tag_id",a.join()),t.append("img",r.img),t.append("category",r.ctg.id),F()({url:e,method:"post",data:t}).then((function(e){console.log(e)}))}}},"\u4e0a\u4f20\u6587\u7ae0")),c.a.createElement("div",{className:"flex"},c.a.createElement(M.a,{type:"text",value:s,onChange:function(e){u(e.target.value)}}),c.a.createElement(G.a,{type:"primary",onClick:function(){w()}},"\u65b0\u589e\u6807\u7b7e")),c.a.createElement("div",{className:"flex"},c.a.createElement(M.a,{type:"text",value:f,onChange:function(e){g(e.target.value)}}),c.a.createElement(G.a,{type:"primary",onClick:function(){w("category")}},"\u65b0\u589e\u5206\u7c7b")),c.a.createElement("div",{className:"flex"},c.a.createElement(M.a,{type:"file",ref:y}),c.a.createElement(G.a,{type:"primary",onClick:function(){var e=y.current.files,t=new FormData;t.append("image",e[0]),t.append("msg","abcd"),F()({url:"".concat(j.host,"/upload"),method:"post",data:t}).then((function(e){console.log(e);var t=j.host+e.data.data;l({type:"CHANGE_IMG",val:t})}))}},"\u4e0a\u4f20\u56fe\u7247")),c.a.createElement("div",{className:"flex"},c.a.createElement(M.a,{type:"text",value:h,onChange:function(e){O(e.target.value)}}),c.a.createElement(G.a,{type:"primary",onClick:function(){l({type:"CHANGE_IMG",val:h})}},"\u4f7f\u7528\u5df2\u6709\u56fe\u7247")),c.a.createElement("img",{src:r.img,alt:"\u5c01\u9762\u56fe\u7247",style:{height:r.img?"100px":"0px",width:"auto",visibility:r.img?"visible":"hidden",display:"block"}}),c.a.createElement(I.a,{showSearch:!0,style:{width:200},placeholder:"Select a tag",optionFilterProp:"children",onChange:N,onBlur:T,onSearch:k,filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0}},e.tagsList.map((function(e){return c.a.createElement(P,{value:"".concat(e.tag_name,"$_$").concat(e.id),key:e.id},e.tag_name)}))),r.tags.map((function(e){return c.a.createElement(L.a,{color:"#2db7f5",key:e.id,closable:!0,onClose:function(){var t;t=e.id,l({type:"REMOVE_TAG",val:t})}},e.tag_name)})),c.a.createElement("br",null),c.a.createElement(I.a,{showSearch:!0,style:{width:200},placeholder:"Select a \u5206\u7c7b",optionFilterProp:"children",onChange:_,onBlur:T,onSearch:k,filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0}},e.ctgList.map((function(e){return c.a.createElement(P,{value:"".concat(e.category_name,"$_$").concat(e.id),key:e.id},e.category_name)}))),r.ctg.name?c.a.createElement(L.a,{color:"#2db7f5",closable:!0,onClose:function(){l({type:"REMOVE_CTG"})}},r.ctg.name):"",c.a.createElement("br",null),c.a.createElement("div",{className:"flex content"},c.a.createElement("div",{className:"inner-content"},c.a.createElement(V,{value:r.content,onChange:function(e){return C(e,"changeContent")},placeholder:"\u6587\u7ae0\u5185\u5bb9"})),c.a.createElement("div",{className:"inner-content"},c.a.createElement(B.a,{source:r.content}))))}));a(351);function z(){var e=Object(n.useContext)(d),t=Object(n.useState)([]),a=Object(b.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)((function(){F.a.get("".concat(e.host,"/files/ls")).then((function(t){var a=t.data;l(a.list.map((function(t){return e.host+t.name})))}))}),[e.host]),c.a.createElement("div",{className:"gallary-wrap"},c.a.createElement("h1",null,"\u56fe\u5e93"),c.a.createElement("div",{className:"inner-wrap"},r.map((function(t,a){return c.a.createElement("div",{key:a,className:"img-wrap"},c.a.createElement("img",{src:t,alt:t}),c.a.createElement("br",null),c.a.createElement("span",{onClick:function(){!function(t){var a=document.createElement("input");a.value=t,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),e.showToast("\u62f7\u8d1d\u56fe\u7247\u5730\u5740\u6210\u529f")}(t)}},t))}))))}a(352),a(353);var q=Object(m.b)((function(e){return Object(u.a)({},e)}),{getArticleList:function(e){return function(){var t=Object(s.a)(o.a.mark((function t(a){var n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.a.get("".concat(e,"/articles"));case 2:n=t.sent,c=n.data,a({type:"GET_ARTICLE_LIST",val:c});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},getTagsList:function(e){return function(){var t=Object(s.a)(o.a.mark((function t(a){var n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.a.get("".concat(e,"/tags"));case 2:n=t.sent,c=n.data,a({type:"GET_TAGS_LIST",val:c});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},getCtgList:function(e){return function(){var t=Object(s.a)(o.a.mark((function t(a){var n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.a.get("".concat(e,"/category/count"));case 2:n=t.sent,c=n.data,a({type:"GET_CTG_LIST",val:c});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=Object(n.useContext)(d),a=Object(n.useMemo)((function(){return[{path:"/index",cmp:w},{path:"/catagory",cmp:T},{path:"/tags",cmp:k},{path:"/write",cmp:W},{path:"/pic",cmp:z}]}),[]);return Object(n.useEffect)((function(){e.getArticleList(t.host),e.getTagsList(t.host),e.getCtgList(t.host)}),[]),c.a.createElement(N.a,null,c.a.createElement(_,null,c.a.createElement("span",null)),c.a.createElement("div",{className:"app"},a.map((function(e,t){return c.a.createElement(O.b,{path:e.path,component:e.cmp,key:t})})),c.a.createElement(O.a,{exact:!0,from:"/",to:"/index"})))})),K=a(136),Q=a(137),U=a(76),X=a(142),Z=a(141),ee=(a(354),function(e){Object(X.a)(a,e);var t=Object(Z.a)(a);function a(e){var n;return Object(K.a)(this,a),(n=t.call(this,e)).timer=null,n.state={show:!1,msg:""},a.showToast=n.show.bind(Object(U.a)(n)),n}return Object(Q.a)(a,[{key:"show",value:function(e){var t=this;clearTimeout(this.timer),this.setState({show:!0,msg:e},(function(){t.stopTimer()}))}},{key:"stopTimer",value:function(){var e=this;this.timer=setTimeout((function(){e.setState({show:!1})}),2e3)}},{key:"render",value:function(){return l.a.createPortal(c.a.createElement("div",{className:"toast",style:{display:this.state.show?"block":"none"}},this.state.msg),document.body)}}]),a}(c.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var te=a(138),ae=a.n(te),ne=(a(355),a(139)),ce=a.n(ne),re=a(63),le=a(140),ie={count:1,articleCount:0,tagsCount:0,ctgCount:0,articleList:[],tagsList:[],sortedArticle:[],ctgList:[]};var oe=Object(re.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.val,c=e.tagsList,r=e.ctgList;switch(a){case"ADD":return Object(u.a)(Object(u.a)({},e),{},{count:e.count+1});case"GET_ARTICLE_LIST":var l=n.list.sort((function(e,t){return t.time-e.time})).slice(0,5);return Object(u.a)(Object(u.a)({},e),{},{articleCount:n.count,articleList:n.list,sortedArticle:l});case"GET_TAGS_LIST":return Object(u.a)(Object(u.a)({},e),{},{tagsCount:n.count,tagsList:n.list});case"ADD_TAG":return c.push(n),console.log({tagsList:c}),Object(u.a)(Object(u.a)({},e),{},{tagsList:Object(D.a)(c)});case"GET_CTG_LIST":return Object(u.a)(Object(u.a)({},e),{},{ctgCount:n.count,ctgList:n.list});case"ADD_CTG":return r.push(n),console.log({ctgList:r}),Object(u.a)(Object(u.a)({},e),{},{ctgList:Object(D.a)(r)});default:return e}}),Object(re.a)(le.a));g.extend(ce.a),g.extend(ae.a),g.locale("zh-cn");var se=document.createElement("div");se.id="cmp-container",document.body.appendChild(se);var ue={host:"http://39.96.31.138",dayjs:g,showToast:function(e){ee.showToast(e)}};l.a.render(c.a.createElement(m.a,{store:oe},c.a.createElement(d.Provider,{value:ue},c.a.createElement(q,null)),c.a.createElement(ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[143,1,2]]]);
//# sourceMappingURL=main.f330d90b.chunk.js.map